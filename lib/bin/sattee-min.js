let Sattee={name:void 0,layers:null,main:null,currentScene:null,currentLayer:void 0,loadedScene:!1,canvasArray:[],mouseIsDragged:!1,frameRate:60,lastFrameDate:void 0,currentFrameDate:void 0,delta:void 0,exited:!1,scenes:{},assets:{},load:function(e){this.assets=e,this.preload()},configure:function({width:e,height:t,layers:n,name:a,container:r,main:i,loopFunction:o}){this.width=e,this.height=t,this.layers=n,this.main=i,this.currentScene=i,this.name=a,this.loopFunction=o;let s=document.createElement("div");this.container=s,s.setAttribute("id",a),s.style.width=`${e}px`,s.style.height=`${t}px`;for(let r=0;r<n;r++){let n=document.createElement("canvas");n.width=`${e}`,n.height=`${t}`,n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.setAttribute("id",a+r),s.appendChild(n),this.canvasArray.push({x:0,y:0,layer:r}),_setCtxToLayer(n)}r&&"string"==typeof r?"#"==r[0]?document.getElementById(r.replace("#","")).appendChild(s):"."==r[0]&&document.getElementsByClassName(r.replace(".","")).appendChild(s):document.body.appendChild(s)},loadImage:function(e,t){let n=new Image;return n.onload=function(){t()},n.src=e,n},loadSound:function(e,t){let n=new Audio(e);return n.onload=function(){t()},n}},entityArray={};function newEntity(e){let t={position:createVector(0,0),velocity:createVector(0,0),_index:0};for(let n in e){let a=e[n];t[n]=a}if("group"in e)if(entityArray[e.group]){let n=entityArray[e.group].length+1;t._index=n,entityArray[e.group].push(t)}else entityArray[e.group]=[]}let loaded=0;function _roundedPoly(e,t,n){var a,r,i,o,s,l,u,c,h,d,f,g,y,m,p,S,v,w,b=function(e,t,n){n.x=t.x-e.x,n.y=t.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)};for(w=n,c={},h={},s=t[(o=t.length)-1],a=0;a<o;a++)l=t[a%o],u=t[(a+1)%o],b(l,s,c),b(l,u,h),d=c.nx*h.ny-c.ny*h.nx,f=c.nx*h.nx-c.ny*-h.ny,m=Math.asin(d),g=1,y=!1,f<0?m<0?m=Math.PI+m:(m=Math.PI-m,g=-1,y=!0):m>0&&(g=-1,y=!0),w=void 0!==l.radius?l.radius:n,p=m/2,(v=Math.abs(Math.cos(p)*w/Math.sin(p)))>Math.min(c.len/2,h.len/2)?(v=Math.min(c.len/2,h.len/2),S=Math.abs(v*Math.sin(p)/Math.cos(p))):S=w,r=l.x+h.nx*v,i=l.y+h.ny*v,r+=-h.ny*S*g,i+=h.nx*S*g,e.arc(r,i,S,c.ang+Math.PI/2*g,h.ang-Math.PI/2*g,y),s=l,l=u;e.closePath()}function _manageOptions(e,t,n){null==t&&(t={});for(let a in n){let[r,i,o]=n[a];null!=t[a]?(Sattee.validate(e).type([t[a],r]),i(t[a])):null!=o&&o()}}function _manageDefaultDrawingOptions(e,t,n){_manageOptions(e,t,{color:["string",()=>{n.fillStyle=t.color}],strokeSize:["number",()=>{n.lineWidth=t.strokeSize}],strokeColor:["string",()=>{n.strokeStyle=t.strokeColor}]})}function _validateDrawingFunction(e,t){Sattee.validate(e).arguments(t,t.length).type("number",t),Sattee.validate()}function _colorize(e,t){t&&e.stroke(),e.fill()}function _setCtxToLayer(e){e.getContext("2d").fillStyle="rgb(51,51,51)"}function _getButtons(e){let t=[];for(let n in Sattee.keys)(Sattee.keys[n]&&!e||!Sattee.keys[n]&&e)&&t.push(String.fromCharCode(n));return t}function runEvent(e,t){Sattee.scenes[Sattee.currentScene][e]&&(t?Sattee.scenes[Sattee.currentScene][e](...t):Sattee.scenes[Sattee.currentScene][e]())}Sattee.preload=function(){let e=Object.keys(Sattee.assets).length,t=0;function n(e,t){for(let n of t)if(e.endsWith(n))return n;return!1}function a(){loaded=e/++t}for(let e in Sattee.assets){let t=Sattee.assets[e],r=!1;if(n(t,[".png",".jpg",".jpeg"]))r=Sattee.loadImage(t,a);else if(n(t,[".mp3",".wav"]))r=Sattee.loadSound(t,a);else if(!n(t,[".mp4"]))throw new Error(`Unsupported file format in the path: (${t}) of the asset: (${e})`);if(!r)throw new Error(`No such asset file (${t})`);Sattee.assets[e]=r}},Sattee.getCanvas=function(e){let t=document.getElementById(`${this.name}${e||this.currentLayer}`);return[t.getContext("2d"),t]},Sattee.draw=function(e,t){Sattee.validate("draw").arguments([e,t],2).type([e,"number",t,"function"]).range(e,0,this.layers-1),this.currentLayer=e,t.apply(this.scenes[this.currentScene]),this.currentLayer=void 0},Sattee.background=function(e,t,n,a){_validateDrawingFunction("background",[e,t,n]),Sattee.validate();let[r,i]=this.getCanvas();r.fillStyle=`rgba(${e},${t},${n},${a&&"number"==typeof a?a:255})`,r.fillRect(-this.canvasArray[this.currentLayer].x,-this.canvasArray[this.currentLayer].y,i.width,i.height)},Sattee.clear=function(e,t){Sattee.validate("clear").arguments([e],1).type([e,"number"]).range(e,0,this.layers);let[n,a]=this.getCanvas(e);t?(Sattee.validate("clear","There was an error with the options in the Sattee.clear() function").arguments([t.x,t.y,t.width,t.height],4).type([t.x,"number",t.y,"number",t.width,"number",t.height,"number"]),x=t.x,y=t.y,t.offset?n.clearRect(x-t.offset,y-t.offset,t.width+2*t.offset,t.height+2*t.offset):n.clearRect(x,y,t.width,t.height)):this.canvasArray[e].translated?n.clearRect(-this.canvasArray[e].x,-this.canvasArray[e].y,a.width,a.height):n.clearRect(0,0,a.width,a.height)},Sattee.rect=function(e,t,n,a,r){_validateDrawingFunction("rect",[e,t,n,a]);let[i]=this.getCanvas();i.save(),_manageDefaultDrawingOptions("rect",r,i);let o=e,s=t;_manageOptions("rect",r,{rotateX:["number",e=>{o=e}],rotateY:["number",e=>{s=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,o,s,function(){i.rotate(e*Math.PI/180)})}],borderRadius:["object",r=>{let o={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};if(null!=r.all)for(let e in o)o[e]=r.all;else if(null==r.upperLeft&&null==r.upperRight&&null==r.lowerLeft&&null==r.lowerRight)throw new Error("There was an error in the borderRadius option in the Sattee.rect(); function");for(let e in r)o[e]=r[e];let s=Math.min(n,a);for(let e in o)o[e]>s&&(o[e]=s/2);i.beginPath(),i.moveTo(e+o.upperLeft,t),i.lineTo(e+n-o.upperRight,t),i.quadraticCurveTo(e+n,t,e+n,t+o.upperRight),i.lineTo(e+n,t+a-o.lowerRight),i.quadraticCurveTo(e+n,t+a,e+n-o.lowerRight,t+a),i.lineTo(e+o.lowerLeft,t+a),i.quadraticCurveTo(e,t+a,e,t+a-o.lowerLeft),i.lineTo(e,t+o.upperLeft),i.quadraticCurveTo(e,t,e+o.upperLeft,t),i.closePath()},()=>{i.beginPath(),i.rect(e,t,n,a)}]}),_colorize(i,r&&null!=r.strokeSize),i.restore()},Sattee.ellipse=function(e,t,n,a,r){_validateDrawingFunction("ellipse",[e,t,n,a]);let[i]=this.getCanvas();i.save(),_manageDefaultDrawingOptions("ellipse",r,i),i.beginPath(),i.ellipse(e+n/2,t+a/2,n/2,a/2,0,90,90),_colorize(i,r&&null!=r.strokeSize),i.restore()},Sattee.triangle=function(e,t,n,a,r,i,o){_validateDrawingFunction("triangle",[e,t,n,a,r,i]);let[s]=Sattee.getCanvas();s.save(),_manageDefaultDrawingOptions("triangle",o,s);let l=e,u=t;_manageOptions("triangle",o,{rotateX:["number",e=>{l=e}],rotateY:["number",e=>{u=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,l,u,function(){s.rotate(e*Math.PI/180)})}],borderRadius:["object",o=>{let l={A:0,B:0,C:0,all:0};if(null!=o.all)for(let e in l)l[e]=o.all;else if(null==o.A&&null==o.B&&null==o.C)throw new Error("There was an error in the borderRadius option in the Sattee.translate(); function");for(var u in o)l[u]=o[u];_roundedPoly(s,[{x:e,y:t,radius:l.A},{x:n,y:a,radius:l.B},{x:r,y:i,radius:l.C}],l.all)},()=>{s.beginPath(),s.moveTo(e,t),s.lineTo(n,a),s.lineTo(r,i),s.lineTo(e,t)}]}),_colorize(s,o&&null!=o.strokeSize),s.restore()},Sattee.line=function(e,t,n,a,r){_validateDrawingFunction("line",[e,t,n,a]);let[i]=this.getCanvas();i.save(),_manageDefaultDrawingOptions("line",r,i);let o=e,s=t;_manageOptions("line",r,{rotateX:["number",e=>{o=e}],rotateY:["number",e=>{s=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,o,s,function(){i.rotate(e*Math.PI/180)})}]}),i.beginPath(),i.moveTo(e,t),i.lineTo(n,a),_colorize(i,r&&null!=r.strokeSize),i.restore()},Sattee.translate=function(e,t,n,a){Sattee.validate("translate").arguments([e,t,n,a],4).type([e,"number",t,"number",n,"number",a,"function"]).range(e,0,this.layers);let[r]=this.getCanvas(e);r.translate(t,n),this.canvasArray[e].translated=!0,this.canvasArray[e].x=t,this.canvasArray[e].y=n,a.apply(this.scenes[this.currentScene]),r.translate(-t,-n),this.canvasArray[e].translated=!1,this.canvasArray[e].x=-t,this.canvasArray[e].y=-n},Sattee.init=function(e,t){t.setuped=!1,this.scenes[e]=t,0==this.loadedScene&&(this.loadedScene=!0,this.switchScene(this.main)),this._loadEvents(this.container)},Sattee.switchScene=function(e,t){if(!this.scenes[e])throw new Error(`The specified scene (${e}) is missing. Check your code!`);if(this.exited)throw new Error("Trying to play a scene after Sattee.exit(); is called!");t&&(this.scenes[e].setuped=!1),this.currentScene=e;let n=this.currentScene;this.scenes[e].setuped||(this.scenes[e].setuped=!0,this.scenes[e].setup.apply(this.scenes[e]));let a=this.scenes[e].loop.bind(this.scenes[e]);!function e(){if(n==Sattee.currentScene&&!Sattee.exited){{null==Sattee.lastFrameDate&&(Sattee.lastFrameDate=new Date),Sattee.currentFrameDate=new Date,Sattee.delta=(Sattee.currentFrameDate.getTime()-Sattee.lastFrameDate.getTime())/1e3,Sattee.lastFrameDate=Sattee.currentFrameDate,a();let e=_getButtons();e.length>0&&runEvent("keyDown",[e]);let t=_getButtons(!0);if(t.length>0){runEvent("keyUp",[...t]);for(let e in Sattee.keys)0==Sattee.keys[e]&&delete Sattee.keys[e]}Sattee.mouseIsDragged&&runEvent("mouseDragged")}if("interval"==Sattee.loopFunction)setInterval(function(){e()},1e3/Sattee.frameRate);else if("timeout"==Sattee.loopFunction)setTimeout(function(){e()},1e3/Sattee.frameRate);else{if("animation"!=Sattee.loopFunction)throw new Error('You need to specify a loop function in the config. If you are not sure what to use, use timeout. (loopfunction:"timeout")');window.requestAnimationFrame(e)}}}()},Sattee.exit=function(){this.exited=!0},Sattee.keys={},onkeydown=onkeyup=function(e){let t="keydown"==e.type;9==e.keyCode&&e.preventDefault(),Sattee.keys[e.keyCode||e.which]=t};let getMPos=function(e){let t=document.getElementById(`${Sattee.name}0`).getBoundingClientRect();Sattee.prevmouseX=Sattee.mouseX||e.clientX-t.left,Sattee.prevmouseY=Sattee.mouseY||e.clientY-t.top,Sattee.mouseX=e.clientX-t.left,Sattee.mouseY=e.clientY-t.top};Sattee._loadEvents=function(e){e.addEventListener("mousemove",function(e){getMPos(e)}),e.addEventListener("click",function(){runEvent("mouseClicked")}),e.addEventListener("mouseup",function(){Sattee.mouseIsDragged=!1,runEvent("mouseReleased")}),e.addEventListener("mousedown",function(){Sattee.mouseIsDragged=!0,runEvent("mouseDown")}),e.addEventListener("keydown",onkeydown),e.addEventListener("keyup",onkeyup)},Sattee.validate=function(e){let t={};if(t.msg=`There was an error in the Sattee.${e}(); function.\n`,!e&&null==this.currentLayer)throw new Error("You are not allowed to draw on the canvas outside the Sattee.draw function");return t.arguments=function(e,t,n){let a=n||"not enough or invald arguments",r=!1;for(let t=0;t<e.length;t++)if(void 0===e[t]){r=!0;break}if(e.length!=t||r)throw new Error(this.msg+a);return this},t.range=function(e,t,n,a){let r=a||"one or more of the arguments with type of number is with invalid range";if(e<t||e>n)throw new Error(this.msg+r);return this},t.type=function(e,t){let n=t||"wrong type of argument on one or more of the give arguments";if("string"==typeof e){for(let a of t)if(typeof a!=e)throw new Error(this.msg+n)}else{let t=!1;for(let n=0;n<e.length;n+=2)if(typeof e[n]!=e[n+1]){t=!0;break}if(t)throw new Error(this.msg+n)}return this},t},Sattee.distance=function(e,t,n,a){Sattee.validate("distance").arguments([e,t,n,a],4);try{Sattee.validate("distance").type("number",[e,t,n,a]);let r=e-n,i=t-a;return Math.sqrt(r*r+i*i)}catch(e){}},Sattee.midPoint=function(e,t,n,a){let r=0,i=0,o=this.distance(e,t,n,a);return{x:r=e>n?e+o/2:n>e?n-o/2:e,y:i=t>a?t+o/2:a>t?a-o/2:t}};