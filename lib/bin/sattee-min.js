let Sattee={name:void 0,layers:null,main:null,currentScene:null,currentLayer:void 0,canvasArray:[],mouseX:0,mouseY:0,mouseIsDragged:!1,frameRate:void 0,lastFrameDate:void 0,currentFrameDate:void 0,delta:void 0,exited:!1,scenes:{},assets:{},load:function(e){this.assets=e,this.preload()},configure:function({width:e,height:t,layers:a,name:n,container:r,main:s,loopFunction:i}){this.width=e,this.height=t,this.layers=a,this.main=s,this.currentScene=s,this.name=n,this.loopFunction=i;let o=document.createElement("div");this.container=o,o.setAttribute("id",n),o.style.width=`${e}px`,o.style.height=`${t}px`;for(let r=0;r<a;r++){let a=document.createElement("canvas");a.width=`${e}`,a.height=`${t}`,a.style.position="absolute",a.style.left="0px",a.style.top="0px",a.setAttribute("id",n+r),o.appendChild(a),this.canvasArray.push({x:0,y:0,layer:r}),this._setCtxToLayer(a)}o.focus(),r&&"string"==typeof r?"#"==r[0]?document.getElementById(r.replace("#","")).appendChild(o):"."==r[0]&&document.getElementsByClassName(r.replace(".","")).appendChild(o):document.body.appendChild(o)}},entityArray={};function newEntity(e){let t={position:createVector(0,0),velocity:createVector(0,0),_index:0};for(let a in e){let n=e[a];t[a]=n}if("group"in e)if(entityArray[e.group]){let a=entityArray[e.group].length+1;t._index=a,entityArray[e.group].push(t)}else entityArray[e.group]=[]}Sattee.loaded=0,Sattee.loadVideo=function(e,t){let a=document.createElement("video");return a.src=e,a.removeAttribute("autoplay"),a.isPaused=!1,a.hasEnded=!1,a.playFunction=function(){0==a.isPaused&&0==a.hasEnded&&(Sattee.image.givenCtx=a.givenCtx,Sattee.image.givenLayer=a.givenLayer,Sattee.image(a,a.givenX,a.givenY,a.givenW,a.givenH,a.givenOptions))},a.onplaying=function(){},a.oncanplay=function(){t()},a},Sattee.loadImage=function(e,t){let a=new Image;return a.onload=function(){t()},a.src=e,a},Sattee.loadSound=function(e,t){let a=new Audio(e);return a.onload=function(){t()},a},Sattee.preload=function(){Object.defineProperty(HTMLMediaElement.prototype,"playing",{get:function(){return!!(this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2)}});let e=Object.keys(Sattee.assets).length,t=0;function a(e,t){for(let a of t)if(e.endsWith(a))return a;return!1}function n(){t++,Sattee.loaded=e/t*100,100==Sattee.loaded&&Sattee.switchScene(Sattee.main)}for(let e in Sattee.assets){let t=Sattee.assets[e],r=!1;if(a(t,[".png",".jpg",".jpeg"]))r=Sattee.loadImage(t,n);else if(a(t,[".mp3",".wav"]))r=Sattee.loadSound(t,n);else{if(!a(t,[".mp4"]))throw new Error(`Unsupported file format in the path: (${t}) of the asset: (${e})`);r=Sattee.loadVideo(t,n)}if(!r)throw new Error(`No such asset file (${t})`);Sattee.assets[e]=r}},function(){function e(e,t,a){null==t&&(t={});for(let n in a){let[r,s,i]=a[n];null!=t[n]?(Sattee.validate(e).type([t[n],r]),s(t[n])):null!=i&&i()}}function t(t,a,n){e(t,a,{color:["string",()=>{n.fillStyle=a.color}],strokeSize:["number",()=>{n.lineWidth=a.strokeSize}],strokeColor:["string",()=>{n.strokeStyle=a.strokeColor}]})}function a(e,t){Sattee.validate(e).arguments(t,t.length).type("number",t),Sattee.validate()}function n(e,t){t&&e.stroke(),e.fill()}Sattee.getCanvas=function(e){let t=document.getElementById(`${this.name}${null!=e?e:this.currentLayer}`);return[t.getContext("2d"),t]},Sattee._setCtxToLayer=function(e){let t=e.getContext("2d");t.fillStyle="rgb(51,51,51)",t.font="30px Sans-serif",t.lineCap="round"},Sattee.draw=function(e,t){Sattee.validate("draw").arguments([e,t],2).type([e,"number",t,"function"]).range(e,0,this.layers-1),this.currentLayer=e,t.apply(this.scenes[this.currentScene]),this.currentLayer=void 0},Sattee.clear=function(e,t){Sattee.validate("clear").arguments([e],1).type([e,"number"]).range(e,0,this.layers-1);let[a,n]=this.getCanvas(e);t?(Sattee.validate("clear","There was an error with the options in the Sattee.clear() function").arguments([t.x,t.y,t.width,t.height],4).type([t.x,"number",t.y,"number",t.width,"number",t.height,"number"]),x=t.x,y=t.y,t.offset?a.clearRect(x-t.offset,y-t.offset,t.width+2*t.offset,t.height+2*t.offset):a.clearRect(x,y,t.width,t.height)):this.canvasArray[e].translated?a.clearRect(-this.canvasArray[e].x,-this.canvasArray[e].y,n.width,n.height):a.clearRect(0,0,n.width,n.height)},Sattee.translate=function(e,t,a,n){Sattee.validate("translate").arguments([e,t,a,n],4).type([e,"number",t,"number",a,"number",n,"function"]).range(e,0,this.layers-1);let[r]=this.getCanvas(e);r.translate(t,a),this.canvasArray[e].translated=!0,this.canvasArray[e].x=t,this.canvasArray[e].y=a,n.apply(this.scenes[this.currentScene]),r.translate(-t,-a),this.canvasArray[e].translated=!1,this.canvasArray[e].x=-t,this.canvasArray[e].y=-a},Sattee.scale=function(e,t,a,n){Sattee.validate("translate").arguments([e,t,a,n],4).type([e,"number",t,"number",a,"number",n,"function"]).range(e,0,this.layers-1);let[r]=this.getCanvas(e);r.scale(t,a),this.canvasArray[e].scaled=!0,this.canvasArray[e].sx=t,this.canvasArray[e].sy=a,n.apply(this.scenes[this.currentScene]),r.scale(1/t,1/a),this.canvasArray[e].scaled=!1,this.canvasArray[e].sx=1/t,this.canvasArray[e].sy=1/a},Sattee.background=function(e){Sattee.validate("background").arguments([e],1).type([e,"string"]),Sattee.validate();let[t,a]=this.getCanvas();t.save(),t.fillStyle=e;let n=0,r=0,s=a.width,i=a.height;this.canvasArray[this.currentLayer].translated&&(n-=this.canvasArray[this.currentLayer].x,r-=this.canvasArray[this.currentLayer].y),this.canvasArray[this.currentLayer].scaled&&(s/=this.canvasArray[this.currentLayer].sx,i/=this.canvasArray[this.currentLayer].sy,this.canvasArray[this.currentLayer].translated&&(n-=Sattee.width-this.canvasArray[this.currentLayer].sx*Sattee.width,r-=Sattee.height-this.canvasArray[this.currentLayer].sy*Sattee.width,s+=Sattee.width-this.canvasArray[this.currentLayer].sx*Sattee.width,i+=Sattee.height-this.canvasArray[this.currentLayer].sy*Sattee.width)),t.fillRect(n,r,s,i),t.restore()},Sattee.rect=function(r,s,i,o,l){a("rect",[r,s,i,o]);let[u]=this.getCanvas();u.save(),t("rect",l,u);let c=r,d=s;e("rect",l,{center:["boolean",()=>{r-=i/2,s-=o/2}],rotateX:["number",e=>{c=e}],rotateY:["number",e=>{d=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,c,d,function(){u.rotate(e*Math.PI/180)})}],borderRadius:["object",e=>{let t={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};if(null!=e.all)for(let a in t)t[a]=e.all;else if(null==e.upperLeft&&null==e.upperRight&&null==e.lowerLeft&&null==e.lowerRight)throw new Error("There was an error in the borderRadius option in the Sattee.rect(); function");for(let a in e)t[a]=e[a];let a=Math.min(i,o);if(null==t.all)for(let e in t)t[e]>a&&(t[e]=a/2);else for(let e in t)t[e]>a/2&&(t[e]=a/2);u.beginPath(),u.moveTo(r+t.upperLeft,s),u.lineTo(r+i-t.upperRight,s),u.quadraticCurveTo(r+i,s,r+i,s+t.upperRight),u.lineTo(r+i,s+o-t.lowerRight),u.quadraticCurveTo(r+i,s+o,r+i-t.lowerRight,s+o),u.lineTo(r+t.lowerLeft,s+o),u.quadraticCurveTo(r,s+o,r,s+o-t.lowerLeft),u.lineTo(r,s+t.upperLeft),u.quadraticCurveTo(r,s,r+t.upperLeft,s),u.closePath()},()=>{u.beginPath(),u.rect(r,s,i,o)}]}),n(u,l&&null!=l.strokeSize),u.restore()},Sattee.ellipse=function(r,s,i,o,l){a("ellipse",[r,s,i,o]);let[u]=this.getCanvas();u.save(),t("ellipse",l,u),e("ellipse",l,{center:["boolean",()=>{r-=i/2,s-=o/2}]}),u.beginPath(),u.ellipse(r+i/2,s+o/2,i/2,o/2,0,90,90),n(u,l&&null!=l.strokeSize),u.restore()},Sattee.triangle=function(r,s,i,o,l,u,c){a("triangle",[r,s,i,o,l,u]);let[d]=Sattee.getCanvas();d.save(),t("triangle",c,d);let h=r,S=s;e("triangle",c,{rotateX:["number",e=>{h=e}],rotateY:["number",e=>{S=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,h,S,function(){d.rotate(e*Math.PI/180)})}],borderRadius:["object",e=>{let t={A:0,B:0,C:0,all:0};if(null!=e.all)for(let a in t)t[a]=e.all;else if(null==e.A&&null==e.B&&null==e.C)throw new Error("There was an error in the borderRadius option in the Sattee.translate(); function");for(var a in e)t[a]=e[a];!function(e,t,a){var n,r,s,i,o,l,u,c,d,h,S,y,f,g,m,p,v,w,b=function(e,t,a){a.x=t.x-e.x,a.y=t.y-e.y,a.len=Math.sqrt(a.x*a.x+a.y*a.y),a.nx=a.x/a.len,a.ny=a.y/a.len,a.ang=Math.atan2(a.ny,a.nx)};for(w=a,c={},d={},o=t[(i=t.length)-1],n=0;n<i;n++)l=t[n%i],u=t[(n+1)%i],b(l,o,c),b(l,u,d),h=c.nx*d.ny-c.ny*d.nx,S=c.nx*d.nx-c.ny*-d.ny,g=Math.asin(h),y=1,f=!1,S<0?g<0?g=Math.PI+g:(g=Math.PI-g,y=-1,f=!0):g>0&&(y=-1,f=!0),w=void 0!==l.radius?l.radius:a,m=g/2,(v=Math.abs(Math.cos(m)*w/Math.sin(m)))>Math.min(c.len/2,d.len/2)?(v=Math.min(c.len/2,d.len/2),p=Math.abs(v*Math.sin(m)/Math.cos(m))):p=w,r=l.x+d.nx*v,s=l.y+d.ny*v,r+=-d.ny*p*y,s+=d.nx*p*y,e.arc(r,s,p,c.ang+Math.PI/2*y,d.ang-Math.PI/2*y,f),o=l,l=u;e.closePath()}(d,[{x:r,y:s,radius:t.A},{x:i,y:o,radius:t.B},{x:l,y:u,radius:t.C}],t.all)},()=>{d.beginPath(),d.moveTo(r,s),d.lineTo(i,o),d.lineTo(l,u),d.lineTo(r,s)}]}),n(d,c&&null!=c.strokeSize),d.restore()},Sattee.line=function(r,s,i,o,l){a("line",[r,s,i,o]);let[u]=this.getCanvas();u.save(),t("line",l,u);let c=r,d=s;e("line",l,{rotateX:["number",e=>{c=e}],rotateY:["number",e=>{d=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,c,d,function(){u.rotate(e*Math.PI/180)})}]}),u.beginPath(),u.moveTo(r,s),u.lineTo(i,o),n(u,l&&null!=l.strokeSize),u.restore()},Sattee.text=function(t,a,n,r){Sattee.validate("text").arguments([t,a,n],3).type([t,"string",a,"number",n,"number"]),Sattee.validate();let[s]=this.getCanvas();s.save();let i=a,o=n;e("text",r,{rotateX:["number",e=>{i=e}],rotateY:["number",e=>{o=e}],rotate:["number",e=>{Sattee.translate(Sattee.currentLayer,i,o,function(){s.rotate(e*Math.PI/180)})}]}),e("text",r,{size:["number",()=>{s.font=`${r.size}pt Sans-serif`}],strokeSize:["number",()=>{s.lineWidth=r.strokeSize}],strokeColor:["string",()=>{null!=r.strokeSize&&(s.strokeStyle=r.strokeColor,s.lineJoin="miter",s.miterLimit=2,s.strokeText(t,a,n))}],color:["string",()=>{s.fillStyle=r.color}]}),s.fillText(t,a,n),s.restore()},Sattee.textWidth=function(e,t){Sattee.validate("textWidth").arguments([e,t],2).type([e,"string",t,"number"]);let a=document.createElement("canvas").getContext("2d");return a.font=`${t}pt Sans-serif`,a.measureText(e).width},Sattee.textHeight=function(e,t){Sattee.validate("textHeight").arguments([e,t],2).type([e,"string",t,"number"]);let a=document.createElement("div");a.innerHTML=e,a.style.position="absolute",a.style.top="-9999px",a.style.left="-9999px",a.style.fontFamily="Sans-serif",a.style.fontWeight="normal",a.style.fontSize=t+"pt",document.body.appendChild(a);let n=a.offsetHeight;return document.body.removeChild(a),n},Sattee.image=function(e,t,a,n,r,s){let i,o;if(Sattee.validate("image").arguments([t,a],2).type([t,"number",a,"number"]),"string"==typeof e){if(null==Sattee.assets[e])throw new Error(`Error in the Sattee.image function.\nThe given image ${e} is not loaded or is invalid.`);i=Sattee.assets[e],o=Sattee.getCanvas()[0]}else"object"==typeof e&&(i=e,o=Sattee.image.givenCtx);if(o.save(),null!=s&&(null!=s.strokeSize||null!=s.borderRadius)){let i={stroke:s.stroke,strokeSize:s.strokeSize,strokeColor:s.strokeColor,borderRadius:s.borderRadius,dontClosePathToCtx:!0};"string"==typeof e?Sattee.draw(Sattee.currentLayer,function(){Sattee.rect(t,a,n,r,i)}):"object"==typeof e&&Sattee.draw(Sattee.image.givenLayer,function(){Sattee.rect(t,a,n,r,i)}),o.clip()}o.drawImage(i,t,a,null!=n&&"number"==typeof n?n:void 0,null!=r&&"number"==typeof r?r:void 0),o.closePath(),o.restore()},Sattee.video=function(t,a,n,r,s,i){if(Sattee.validate("video").arguments([t,a,n],3).type([t,"string",a,"number",n,"number"]),null==Sattee.assets[t])throw new Error(`Error in the Sattee.video function.\nThe given video ${t} is not loaded or is invalid.`);let[o]=Sattee.getCanvas();e("video",i,{ended:["function",()=>{Sattee.assets[t].onended=function(){i.ended()}}],time:["number",()=>{Sattee.assets[t].currentTime=i.time}],status:["string",()=>{"play"==i.status?(0==Sattee.assets[t].playing&&Sattee.assets[t].play(),Sattee.assets[t].isPaused=!1,Sattee.assets[t].hasEnded=!1,Sattee.assets[t].muted=!1,Sattee.assets[t].givenX=a,Sattee.assets[t].givenY=n,Sattee.assets[t].givenW=r,Sattee.assets[t].givenH=s,Sattee.assets[t].givenCtx=o,Sattee.assets[t].givenLayer=Sattee.currentLayer,Sattee.assets[t].givenOptions=i,i.frameRate&&"number"==typeof i.frameRate&&(Sattee.assets[t].givenFPS=i.frameRate),Sattee.assets[t].playFunction()):"pause"==i.status?(Sattee.assets[t].isPaused=!0,Sattee.assets[t].muted=!0,Sattee.assets[t].pause()):"stop"==i.status&&(Sattee.assets[t].muted=!0,Sattee.assets[t].isPaused=!0,Sattee.assets[t].currentTime=0)}]})}}(),Sattee.init=function(e,t){t.setuped=!1,this.scenes[e]=t,this._loadEvents(this.container)},Sattee.switchScene=function(e,t){if(!this.scenes[e])throw new Error(`The specified scene (${e}) is missing. Check your code!`);if(1==Sattee.exited&&1==Sattee.exitIsCalled)throw new Error("Trying to play a scene after Sattee.exit(); is called!");t&&(this.scenes[e].setuped=!1),Sattee.currentScene=e;let a=Sattee.currentScene;if(Sattee.scenes[e].setuped||(Sattee.scenes[e].setuped=!0,null!=Sattee.scenes[e].setup&&Sattee.scenes[e].setup.apply(Sattee.scenes[e])),null!=Sattee.scenes[e].loop){let t=Sattee.scenes[e].loop.bind(Sattee.scenes[e]);Sattee.lastFrameDate=Date.now(),function e(){window.requestAnimationFrame(e);if(a!=Sattee.currentScene||0!=Sattee.exited)return;if(Sattee.currentFrameDate=Date.now(),Sattee.delta=Sattee.currentFrameDate-Sattee.lastFrameDate,null==Sattee.frameRate||Sattee.delta>1e3/Sattee.frameRate){Sattee.lastFrameDate=Sattee.currentFrameDate-Sattee.delta%1e3/Sattee.frameRate,t();let e=Sattee._getButtons();e.length>0&&Sattee._runEvent("keyDown",[e]);let a=Sattee._getButtons(!0);if(a.length>0){Sattee._runEvent("keyUp",[...a]);for(let e in Sattee.keys)0==Sattee.keys[e]&&delete Sattee.keys[e]}Sattee.mouseIsDragged&&Sattee._runEvent("mouseDragged")}}()}},Sattee.exit=function(){console.log(arguments.callee.caller.name),Sattee.exited=!0,Sattee.exitIsCalled=!0},function(){Sattee._getButtons=function(e){let t=[];for(let a in Sattee.keys)(Sattee.keys[a]&&!e||!Sattee.keys[a]&&e)&&t.push(String.fromCharCode(a));return t},Sattee._runEvent=function(e,t){Sattee.scenes[Sattee.currentScene][e]&&(t?Sattee.scenes[Sattee.currentScene][e](...t):Sattee.scenes[Sattee.currentScene][e]())},Sattee.keys={},onkeydown=onkeyup=function(e){let t="keydown"==e.type;9==e.keyCode&&e.preventDefault(),Sattee.keys[e.keyCode||e.which]=t};Sattee._loadEvents=function(e){e.addEventListener("mousemove",function(e){!function(e){let t=document.getElementById(`${Sattee.name}0`).getBoundingClientRect();Sattee.prevmouseX=Sattee.mouseX||e.clientX-t.left,Sattee.prevmouseY=Sattee.mouseY||e.clientY-t.top,Sattee.mouseX=e.clientX-t.left,Sattee.mouseY=e.clientY-t.top}(e)}),e.addEventListener("click",function(){Sattee._runEvent("mouseClicked")}),e.addEventListener("mouseup",function(){Sattee.mouseIsDragged=!1,Sattee._runEvent("mouseReleased")}),e.addEventListener("mousedown",function(){Sattee.mouseIsDragged=!0,Sattee._runEvent("mouseDown")}),e.addEventListener("keydown",onkeydown),e.addEventListener("keyup",onkeyup)}}(),Sattee.validate=function(e){let t={};if(t.msg=`There was an error in the Sattee.${e}(); function.\n`,!e&&null==this.currentLayer)throw new Error("You are not allowed to draw on the canvas outside the Sattee.draw function");return t.arguments=function(e,t,a){let n=a||"not enough or invald arguments",r=!1;for(let t=0;t<e.length;t++)if(void 0===e[t]){r=!0;break}if(e.length!=t||r)throw new Error(this.msg+n);return this},t.range=function(e,t,a,n){let r=n||"one or more of the arguments with type of number is with invalid range";if(e<t||e>a)throw new Error(this.msg+r);return this},t.type=function(e,t){let a=t||"wrong type of argument on one or more of the give arguments";if("string"==typeof e){for(let n of t)if(typeof n!=e)throw new Error(this.msg+a)}else{let t=!1;for(let a=0;a<e.length;a+=2)if(typeof e[a]!=e[a+1]){t=!0;break}if(t)throw new Error(this.msg+a)}return this},t},Sattee.distance=function(e,t,a,n){Sattee.validate("distance").arguments([e,t,a,n],4);let r=e-a,s=t-n;return Math.sqrt(r*r+s*s)},Sattee.midPoint=function(e,t,a,n){let r=0,s=0,i=this.distance(e,t,a,n);return{x:r=e>a?e+i/2:a>e?a-i/2:e,y:s=t>n?t+i/2:n>t?n-i/2:t}};